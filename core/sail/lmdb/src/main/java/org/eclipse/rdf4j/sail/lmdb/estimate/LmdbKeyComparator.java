/*******************************************************************************
 * Copyright (c) 2026 Eclipse RDF4J contributors.
 *
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Distribution License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/org/documents/edl-v10.php.
 *
 * SPDX-License-Identifier: BSD-3-Clause
 *******************************************************************************/
// Some portions generated by Codex
package org.eclipse.rdf4j.sail.lmdb.estimate;

import java.nio.ByteBuffer;

final class LmdbKeyComparator {

	private LmdbKeyComparator() {
	}

	static int compare(byte[] left, int leftLength, byte[] right, int rightLength) {
		int len = Math.min(leftLength, rightLength);
		for (int i = 0; i < len; i++) {
			int diff = (left[i] & 0xff) - (right[i] & 0xff);
			if (diff != 0) {
				return diff;
			}
		}
		if (leftLength == rightLength) {
			return 0;
		}
		return leftLength < rightLength ? -1 : 1;
	}

	static int compare(byte[] left, int leftLength, ByteBuffer right, int rightOffset, int rightLength) {
		int len = Math.min(leftLength, rightLength);
		for (int i = 0; i < len; i++) {
			int diff = (left[i] & 0xff) - (right.get(rightOffset + i) & 0xff);
			if (diff != 0) {
				return diff;
			}
		}
		if (leftLength == rightLength) {
			return 0;
		}
		return leftLength < rightLength ? -1 : 1;
	}

	static int compare(ByteBuffer left, int leftOffset, int leftLength, byte[] right, int rightLength) {
		int len = Math.min(leftLength, rightLength);
		for (int i = 0; i < len; i++) {
			int diff = (left.get(leftOffset + i) & 0xff) - (right[i] & 0xff);
			if (diff != 0) {
				return diff;
			}
		}
		if (leftLength == rightLength) {
			return 0;
		}
		return leftLength < rightLength ? -1 : 1;
	}

}
