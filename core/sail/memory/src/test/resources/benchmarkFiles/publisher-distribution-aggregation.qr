PREFIX dcat: <http://www.w3.org/ns/dcat#>
PREFIX dct: <http://purl.org/dc/terms/>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>

SELECT ?publisher (COUNT(DISTINCT ?dataset) AS ?datasets) (COUNT(?dist) AS ?distributionCount) (SAMPLE(?email) AS ?sampleEmail)
WHERE {
    ?dataset a dcat:Dataset ;
             dct:publisher ?publisher ;
             dcat:distribution ?dist .
    OPTIONAL { ?publisher foaf:mbox ?email }
}
GROUP BY ?publisher
HAVING (?datasets > 3)
LIMIT 50
