/*******************************************************************************
 * Copyright (c) 2026 Eclipse RDF4J contributors.
 *
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Distribution License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/org/documents/edl-v10.php.
 *
 * SPDX-License-Identifier: BSD-3-Clause
 *******************************************************************************/
// Some portions generated by Codex
package org.eclipse.rdf4j.query.algebra.evaluation.optimizer.learned;

import static org.junit.jupiter.api.Assertions.assertFalse;
import static org.junit.jupiter.api.Assertions.assertTrue;

import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

class LearnedJoinConfigTest {

	private static final String DP_ENABLED_PROPERTY = "org.eclipse.rdf4j.query.algebra.evaluation.optimizer.learned.LearnedJoinConfig.dpEnabled";

	private String previousValue;

	@BeforeEach
	void rememberProperty() {
		previousValue = System.getProperty(DP_ENABLED_PROPERTY);
	}

	@AfterEach
	void restoreProperty() {
		if (previousValue == null) {
			System.clearProperty(DP_ENABLED_PROPERTY);
		} else {
			System.setProperty(DP_ENABLED_PROPERTY, previousValue);
		}
	}

	@Test
	void defaultConfigReadsSystemProperty() {
		System.setProperty(DP_ENABLED_PROPERTY, "false");

		LearnedJoinConfig disabled = new LearnedJoinConfig();
		assertFalse(disabled.isEnableDp());

		System.setProperty(DP_ENABLED_PROPERTY, "true");

		LearnedJoinConfig enabled = new LearnedJoinConfig();
		assertTrue(enabled.isEnableDp());
	}
}
