


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > FileFormat</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">org.eclipse.rdf4j.common.lang</a>
</div>

<h1>Coverage Summary for Class: FileFormat (org.eclipse.rdf4j.common.lang)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">FileFormat</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    60%
  </span>
  <span class="absValue">
    (12/20)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    40.3%
  </span>
  <span class="absValue">
    (29/72)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    50%
  </span>
  <span class="absValue">
    (43/86)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*******************************************************************************
&nbsp; * Copyright (c) 2015 Eclipse RDF4J contributors, Aduna, and others.
&nbsp; *
&nbsp; * All rights reserved. This program and the accompanying materials
&nbsp; * are made available under the terms of the Eclipse Distribution License v1.0
&nbsp; * which accompanies this distribution, and is available at
&nbsp; * http://www.eclipse.org/org/documents/edl-v10.php.
&nbsp; *
&nbsp; * SPDX-License-Identifier: BSD-3-Clause
&nbsp; *******************************************************************************/
&nbsp;package org.eclipse.rdf4j.common.lang;
&nbsp;
&nbsp;import java.nio.charset.Charset;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.Collection;
&nbsp;import java.util.Collections;
&nbsp;import java.util.List;
&nbsp;import java.util.Locale;
&nbsp;import java.util.Optional;
&nbsp;
&nbsp;/**
&nbsp; * Abstract representation of a file format. File formats are identified by a {@link #getName() name} and can have one
&nbsp; * or more associated MIME types, zero or more associated file extensions and can specify a (default) character
&nbsp; * encoding.
&nbsp; *
&nbsp; * @author Arjohn Kampman
&nbsp; */
<b class="fc">&nbsp;public class FileFormat {</b>
&nbsp;
&nbsp;	/*-----------*
&nbsp;	 * Variables *
&nbsp;	 *-----------*/
&nbsp;
&nbsp;	/**
&nbsp;	 * The file format&#39;s name.
&nbsp;	 */
&nbsp;	private final String name;
&nbsp;
&nbsp;	/**
&nbsp;	 * The file format&#39;s MIME types. The first item in the list is interpreted as the default MIME type for the format.
&nbsp;	 */
&nbsp;	private final List&lt;String&gt; mimeTypes;
&nbsp;
&nbsp;	/**
&nbsp;	 * The file format&#39;s (default) charset.
&nbsp;	 */
&nbsp;	private final Charset charset;
&nbsp;
&nbsp;	/**
&nbsp;	 * The file format&#39;s file extensions. The first item in the list is interpreted as the default file extension for
&nbsp;	 * the format.
&nbsp;	 */
&nbsp;	private final List&lt;String&gt; fileExtensions;
&nbsp;
&nbsp;	/*--------------*
&nbsp;	 * Constructors *
&nbsp;	 *--------------*/
&nbsp;
&nbsp;	/**
&nbsp;	 * Creates a new FileFormat object.
&nbsp;	 *
&nbsp;	 * @param name          The name of the file format, e.g. &quot;PLAIN TEXT&quot;.
&nbsp;	 * @param mimeType      The (default) MIME type of the file format, e.g. &lt;var&gt;text/plain&lt;/var&gt; for plain text files.
&nbsp;	 * @param charset       The default character encoding of the file format. Specify &lt;var&gt;null&lt;/var&gt; if not
&nbsp;	 *                      applicable.
&nbsp;	 * @param fileExtension The (default) file extension for the file format, e.g. &lt;var&gt;txt&lt;/var&gt; for plain text files.
&nbsp;	 */
&nbsp;	public FileFormat(String name, String mimeType, Charset charset, String fileExtension) {
<b class="fc">&nbsp;		this(name, List.of(mimeType), charset, List.of(fileExtension));</b>
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * Creates a new FileFormat object.
&nbsp;	 *
&nbsp;	 * @param name           The name of the file format, e.g. &quot;PLAIN TEXT&quot;.
&nbsp;	 * @param mimeType       The (default) MIME type of the file format, e.g. &lt;var&gt;text/plain&lt;/var&gt; for plain text
&nbsp;	 *                       files.
&nbsp;	 * @param charset        The default character encoding of the file format. Specify &lt;var&gt;null&lt;/var&gt; if not
&nbsp;	 *                       applicable.
&nbsp;	 * @param fileExtensions The file format&#39;s file extension(s), e.g. &lt;var&gt;txt&lt;/var&gt; for plain text files. The first
&nbsp;	 *                       item in the list is interpreted as the default file extension for the format.
&nbsp;	 */
&nbsp;	public FileFormat(String name, String mimeType, Charset charset, Collection&lt;String&gt; fileExtensions) {
<b class="nc">&nbsp;		this(name, List.of(mimeType), charset, fileExtensions);</b>
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * Creates a new FileFormat object.
&nbsp;	 *
&nbsp;	 * @param name           The name of the file format, e.g. &quot;PLAIN TEXT&quot;.
&nbsp;	 * @param mimeTypes      The MIME type(s) of the file format, e.g. &lt;var&gt;text/plain&lt;/var&gt; for theplain text files.
&nbsp;	 *                       The first item in the list is interpreted as the default MIME type for the format. The
&nbsp;	 *                       supplied list should contain at least one MIME type.
&nbsp;	 * @param charset        The default character encoding of the file format. Specify &lt;var&gt;null&lt;/var&gt; if not
&nbsp;	 *                       applicable.
&nbsp;	 * @param fileExtensions The file format&#39;s file extension(s), e.g. &lt;var&gt;txt&lt;/var&gt; for plain text files. The first
&nbsp;	 *                       item in the list is interpreted as the default file extension for the format.
&nbsp;	 */
<b class="fc">&nbsp;	public FileFormat(String name, Collection&lt;String&gt; mimeTypes, Charset charset, Collection&lt;String&gt; fileExtensions) {</b>
<b class="pc">&nbsp;		assert name != null : &quot;name must not be null&quot;;</b>
<b class="pc">&nbsp;		assert mimeTypes != null : &quot;mimeTypes must not be null&quot;;</b>
<b class="pc">&nbsp;		assert !mimeTypes.isEmpty() : &quot;mimeTypes must not be empty&quot;;</b>
<b class="pc">&nbsp;		assert fileExtensions != null : &quot;fileExtensions must not be null&quot;;</b>
&nbsp;
<b class="fc">&nbsp;		this.name = name;</b>
<b class="fc">&nbsp;		this.mimeTypes = new ArrayList&lt;&gt;(mimeTypes);</b>
<b class="fc">&nbsp;		this.charset = charset;</b>
<b class="fc">&nbsp;		this.fileExtensions = new ArrayList&lt;&gt;(fileExtensions);</b>
&nbsp;	}
&nbsp;
&nbsp;	/*---------*
&nbsp;	 * Methods *
&nbsp;	 *---------*/
&nbsp;
&nbsp;	/**
&nbsp;	 * Gets the name of this file format.
&nbsp;	 *
&nbsp;	 * @return A human-readable format name, e.g. &quot;PLAIN TEXT&quot;.
&nbsp;	 */
&nbsp;	public String getName() {
<b class="nc">&nbsp;		return name;</b>
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * Gets the default MIME type for this file format.
&nbsp;	 *
&nbsp;	 * @return A MIME type string, e.g. &quot;text/plain&quot;.
&nbsp;	 */
&nbsp;	public String getDefaultMIMEType() {
<b class="fc">&nbsp;		return mimeTypes.get(0);</b>
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * Checks if the specified MIME type matches the FileFormat&#39;s default MIME type. The MIME types are compared
&nbsp;	 * ignoring upper/lower-case differences.
&nbsp;	 *
&nbsp;	 * @param mimeType The MIME type to compare to the FileFormat&#39;s default MIME type.
&nbsp;	 * @return &lt;var&gt;true&lt;/var&gt; if the specified MIME type matches the FileFormat&#39;s default MIME type.
&nbsp;	 */
&nbsp;	public boolean hasDefaultMIMEType(String mimeType) {
<b class="fc">&nbsp;		return getDefaultMIMEType().equalsIgnoreCase(mimeType);</b>
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * Gets the file format&#39;s MIME types.
&nbsp;	 *
&nbsp;	 * @return An unmodifiable list of MIME type strings, e.g. &quot;text/plain&quot;.
&nbsp;	 */
&nbsp;	public List&lt;String&gt; getMIMETypes() {
<b class="fc">&nbsp;		return Collections.unmodifiableList(mimeTypes);</b>
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * Checks if specified MIME type matches one of the FileFormat&#39;s MIME types. The MIME types are compared ignoring
&nbsp;	 * upper/lower-case differences.
&nbsp;	 *
&nbsp;	 * @param mimeType The MIME type to compare to the FileFormat&#39;s MIME types.
&nbsp;	 * @return &lt;var&gt;true&lt;/var&gt; if the specified MIME type matches one of the FileFormat&#39;s MIME types.
&nbsp;	 */
&nbsp;	public boolean hasMIMEType(String mimeType) {
<b class="pc">&nbsp;		if (mimeType == null) {</b>
<b class="nc">&nbsp;			return false;</b>
&nbsp;		}
<b class="fc">&nbsp;		String type = mimeType;</b>
<b class="pc">&nbsp;		if (mimeType.indexOf(&#39;;&#39;) &gt; 0) {</b>
<b class="nc">&nbsp;			type = mimeType.substring(0, mimeType.indexOf(&#39;;&#39;));</b>
&nbsp;		}
<b class="fc">&nbsp;		for (String mt : this.mimeTypes) {</b>
<b class="pc">&nbsp;			if (mt.equalsIgnoreCase(mimeType)) {</b>
<b class="nc">&nbsp;				return true;</b>
&nbsp;			}
<b class="pc">&nbsp;			if (mimeType != type &amp;&amp; mt.equalsIgnoreCase(type)) {</b>
<b class="nc">&nbsp;				return true;</b>
&nbsp;			}
<b class="fc">&nbsp;		}</b>
&nbsp;
<b class="fc">&nbsp;		return false;</b>
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * Gets the default file name extension for this file format.
&nbsp;	 *
&nbsp;	 * @return A file name extension (excluding the dot), e.g. &quot;txt&quot;, or &lt;var&gt;null&lt;/var&gt; if there is no common file
&nbsp;	 *         extension for the format.
&nbsp;	 */
&nbsp;	public String getDefaultFileExtension() {
<b class="pc">&nbsp;		if (fileExtensions.isEmpty()) {</b>
<b class="nc">&nbsp;			return null;</b>
&nbsp;		} else {
<b class="fc">&nbsp;			return fileExtensions.get(0);</b>
&nbsp;		}
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * Checks if the specified file name extension matches the FileFormat&#39;s default file name extension. The file name
&nbsp;	 * extension MIME types are compared ignoring upper/lower-case differences.
&nbsp;	 *
&nbsp;	 * @param extension The file extension to compare to the FileFormat&#39;s file extension.
&nbsp;	 * @return &lt;var&gt;true&lt;/var&gt; if the file format has a default file name extension and if it matches the specified
&nbsp;	 *         extension, &lt;var&gt;false&lt;/var&gt; otherwise.
&nbsp;	 */
&nbsp;	public boolean hasDefaultFileExtension(String extension) {
<b class="fc">&nbsp;		String ext = getDefaultFileExtension();</b>
<b class="pc">&nbsp;		return ext != null &amp;&amp; ext.equalsIgnoreCase(extension);</b>
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * Gets the file format&#39;s file extensions.
&nbsp;	 *
&nbsp;	 * @return An unmodifiable list of file extension strings, e.g. &quot;txt&quot;.
&nbsp;	 */
&nbsp;	public List&lt;String&gt; getFileExtensions() {
<b class="nc">&nbsp;		return Collections.unmodifiableList(fileExtensions);</b>
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * Checks if the FileFormat&#39;s file extension is equal to the specified file extension. The file extensions are
&nbsp;	 * compared ignoring upper/lower-case differences.
&nbsp;	 *
&nbsp;	 * @param extension The file extension to compare to the FileFormat&#39;s file extension.
&nbsp;	 * @return &lt;var&gt;true&lt;/var&gt; if the specified file extension is equal to the FileFormat&#39;s file extension.
&nbsp;	 */
&nbsp;	public boolean hasFileExtension(String extension) {
<b class="nc">&nbsp;		for (String ext : fileExtensions) {</b>
<b class="nc">&nbsp;			if (ext.equalsIgnoreCase(extension)) {</b>
<b class="nc">&nbsp;				return true;</b>
&nbsp;			}
<b class="nc">&nbsp;		}</b>
&nbsp;
<b class="nc">&nbsp;		return false;</b>
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * Get the (default) charset for this file format.
&nbsp;	 *
&nbsp;	 * @return the (default) charset for this file format, or null if this format does not have a default charset.
&nbsp;	 */
&nbsp;	public Charset getCharset() {
<b class="nc">&nbsp;		return charset;</b>
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * Checks if the FileFormat has a (default) charset.
&nbsp;	 *
&nbsp;	 * @return &lt;var&gt;true&lt;/var&gt; if the FileFormat has a (default) charset.
&nbsp;	 */
&nbsp;	public boolean hasCharset() {
<b class="nc">&nbsp;		return charset != null;</b>
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * Compares FileFormat objects based on their {@link #getName() name}, ignoring case.
&nbsp;	 */
&nbsp;	@Override
&nbsp;	public boolean equals(Object other) {
<b class="nc">&nbsp;		if (this == other) {</b>
<b class="nc">&nbsp;			return true;</b>
&nbsp;		}
&nbsp;
<b class="nc">&nbsp;		if (other instanceof FileFormat) {</b>
<b class="nc">&nbsp;			return name.equalsIgnoreCase(((FileFormat) other).name);</b>
&nbsp;		}
&nbsp;
<b class="nc">&nbsp;		return false;</b>
&nbsp;	}
&nbsp;
&nbsp;	@Override
&nbsp;	public int hashCode() {
<b class="fc">&nbsp;		return name.toLowerCase(Locale.ENGLISH).hashCode();</b>
&nbsp;	}
&nbsp;
&nbsp;	@Override
&nbsp;	public String toString() {
<b class="nc">&nbsp;		StringBuilder sb = new StringBuilder(64);</b>
&nbsp;
<b class="nc">&nbsp;		sb.append(name);</b>
&nbsp;
<b class="nc">&nbsp;		sb.append(&quot; (mimeTypes=&quot;);</b>
<b class="nc">&nbsp;		for (int i = 0; i &lt; mimeTypes.size(); i++) {</b>
<b class="nc">&nbsp;			if (i &gt; 0) {</b>
<b class="nc">&nbsp;				sb.append(&quot;, &quot;);</b>
&nbsp;			}
<b class="nc">&nbsp;			sb.append(mimeTypes.get(i));</b>
&nbsp;		}
&nbsp;
<b class="nc">&nbsp;		sb.append(&quot;; ext=&quot;);</b>
<b class="nc">&nbsp;		for (int i = 0; i &lt; fileExtensions.size(); i++) {</b>
<b class="nc">&nbsp;			if (i &gt; 0) {</b>
<b class="nc">&nbsp;				sb.append(&quot;, &quot;);</b>
&nbsp;			}
<b class="nc">&nbsp;			sb.append(fileExtensions.get(i));</b>
&nbsp;		}
&nbsp;
<b class="nc">&nbsp;		sb.append(&quot;)&quot;);</b>
&nbsp;
<b class="nc">&nbsp;		return sb.toString();</b>
&nbsp;	}
&nbsp;
&nbsp;	/*----------------*
&nbsp;	 * Static methods *
&nbsp;	 *----------------*/
&nbsp;
&nbsp;	/**
&nbsp;	 * Tries to match the specified MIME type with the MIME types of the supplied file formats.
&nbsp;	 *
&nbsp;	 * @param mimeType    A MIME type, e.g. &quot;text/plain&quot;.
&nbsp;	 * @param fileFormats The file formats to match the MIME type against.
&nbsp;	 * @return A FileFormat object if the MIME type was recognized, or {@link Optional#empty()} otherwise.
&nbsp;	 */
&nbsp;	public static &lt;FF extends FileFormat&gt; Optional&lt;FF&gt; matchMIMEType(String mimeType, Iterable&lt;FF&gt; fileFormats) {
&nbsp;		// First try to match with the default MIME type
<b class="fc">&nbsp;		for (FF fileFormat : fileFormats) {</b>
<b class="pc">&nbsp;			if (fileFormat.hasDefaultMIMEType(mimeType)) {</b>
<b class="nc">&nbsp;				return Optional.of(fileFormat);</b>
&nbsp;			}
<b class="fc">&nbsp;		}</b>
&nbsp;
&nbsp;		// Try alternative MIME types too
<b class="fc">&nbsp;		for (FF fileFormat : fileFormats) {</b>
<b class="pc">&nbsp;			if (fileFormat.hasMIMEType(mimeType)) {</b>
<b class="nc">&nbsp;				return Optional.of(fileFormat);</b>
&nbsp;			}
<b class="fc">&nbsp;		}</b>
&nbsp;
<b class="fc">&nbsp;		return Optional.empty();</b>
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * Tries to match the specified file name with the file extensions of the supplied file formats.
&nbsp;	 *
&nbsp;	 * @param fileName    A file name.
&nbsp;	 * @param fileFormats The file formats to match the file name extension against.
&nbsp;	 * @return A FileFormat that matches the file name extension, or {@link Optional#empty()} otherwise.
&nbsp;	 */
&nbsp;	public static &lt;FF extends FileFormat&gt; Optional&lt;FF&gt; matchFileName(String fileName, Iterable&lt;FF&gt; fileFormats) {
&nbsp;		// Strip any directory info from the file name
<b class="fc">&nbsp;		int lastPathSepIdx = Math.max(fileName.lastIndexOf(&#39;/&#39;), fileName.lastIndexOf(&#39;\\&#39;));</b>
<b class="pc">&nbsp;		if (lastPathSepIdx &gt;= 0) {</b>
<b class="fc">&nbsp;			fileName = fileName.substring(lastPathSepIdx + 1);</b>
&nbsp;		}
&nbsp;
&nbsp;		int dotIdx;
<b class="pc">&nbsp;		while ((dotIdx = fileName.lastIndexOf(&#39;.&#39;)) &gt;= 0) {</b>
<b class="fc">&nbsp;			String ext = fileName.substring(dotIdx + 1);</b>
&nbsp;
&nbsp;			// First try to match with the default file extension of the formats
<b class="pc">&nbsp;			for (FF fileFormat : fileFormats) {</b>
<b class="fc">&nbsp;				if (fileFormat.hasDefaultFileExtension(ext)) {</b>
<b class="fc">&nbsp;					return Optional.of(fileFormat);</b>
&nbsp;				}
<b class="fc">&nbsp;			}</b>
&nbsp;
&nbsp;			// Try alternative file extensions too
<b class="nc">&nbsp;			for (FF fileFormat : fileFormats) {</b>
<b class="nc">&nbsp;				if (fileFormat.hasFileExtension(ext)) {</b>
<b class="nc">&nbsp;					return Optional.of(fileFormat);</b>
&nbsp;				}
<b class="nc">&nbsp;			}</b>
&nbsp;
&nbsp;			// No match, check if the file name has more &quot;extensions&quot; (e.g.
&nbsp;			// example.rdf.gz)
<b class="nc">&nbsp;			fileName = fileName.substring(0, dotIdx);</b>
<b class="nc">&nbsp;		}</b>
&nbsp;
<b class="nc">&nbsp;		return Optional.empty();</b>
&nbsp;	}
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2022-09-18 08:20</div>
</div>
</body>
</html>
