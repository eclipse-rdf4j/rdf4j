


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > AbstractQueryResultIOTupleTest</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">org.eclipse.rdf4j.testsuite.query.resultio</a>
</div>

<h1>Coverage Summary for Class: AbstractQueryResultIOTupleTest (org.eclipse.rdf4j.testsuite.query.resultio)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">AbstractQueryResultIOTupleTest</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/28)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/72)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*******************************************************************************
&nbsp; * Copyright (c) 2015 Eclipse RDF4J contributors, Aduna, and others.
&nbsp; *
&nbsp; * All rights reserved. This program and the accompanying materials
&nbsp; * are made available under the terms of the Eclipse Distribution License v1.0
&nbsp; * which accompanies this distribution, and is available at
&nbsp; * http://www.eclipse.org/org/documents/edl-v10.php.
&nbsp; *
&nbsp; * SPDX-License-Identifier: BSD-3-Clause
&nbsp; *******************************************************************************/
&nbsp;
&nbsp;package org.eclipse.rdf4j.testsuite.query.resultio;
&nbsp;
&nbsp;import static org.junit.jupiter.api.Assertions.assertEquals;
&nbsp;
&nbsp;import java.io.ByteArrayInputStream;
&nbsp;import java.io.ByteArrayOutputStream;
&nbsp;import java.io.IOException;
&nbsp;import java.lang.ref.WeakReference;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.Arrays;
&nbsp;import java.util.List;
&nbsp;
&nbsp;import org.eclipse.rdf4j.model.ValueFactory;
&nbsp;import org.eclipse.rdf4j.model.impl.SimpleValueFactory;
&nbsp;import org.eclipse.rdf4j.model.vocabulary.RDF;
&nbsp;import org.eclipse.rdf4j.model.vocabulary.RDFS;
&nbsp;import org.eclipse.rdf4j.model.vocabulary.XSD;
&nbsp;import org.eclipse.rdf4j.query.BindingSet;
&nbsp;import org.eclipse.rdf4j.query.TupleQueryResult;
&nbsp;import org.eclipse.rdf4j.query.impl.IteratingTupleQueryResult;
&nbsp;import org.eclipse.rdf4j.query.impl.MapBindingSet;
&nbsp;import org.eclipse.rdf4j.query.resultio.BooleanQueryResultFormat;
&nbsp;import org.eclipse.rdf4j.query.resultio.QueryResultFormat;
&nbsp;import org.eclipse.rdf4j.query.resultio.QueryResultIO;
&nbsp;import org.eclipse.rdf4j.query.resultio.TupleQueryResultFormat;
&nbsp;import org.junit.jupiter.api.Test;
&nbsp;
&nbsp;/**
&nbsp; * Abstract test for QueryResultIO.
&nbsp; *
&nbsp; * @author jeen
&nbsp; * @author Peter Ansell
&nbsp; */
<b class="nc">&nbsp;public abstract class AbstractQueryResultIOTupleTest extends AbstractQueryResultIOTest {</b>
&nbsp;
&nbsp;	@Override
&nbsp;	protected final QueryResultFormat getFormat() {
<b class="nc">&nbsp;		return getTupleFormat();</b>
&nbsp;	}
&nbsp;
&nbsp;	/**
&nbsp;	 * @return The {@link TupleQueryResultFormat} that this test is running against.
&nbsp;	 */
&nbsp;	protected abstract TupleQueryResultFormat getTupleFormat();
&nbsp;
&nbsp;	/**
&nbsp;	 * @return The {@link BooleanQueryResultFormat} that may be parsed by the same parser as the one for
&nbsp;	 *         {@link #getTupleFormat()}, or null if this functionality is not supported.
&nbsp;	 */
&nbsp;	protected abstract BooleanQueryResultFormat getMatchingBooleanFormatOrNull();
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testSPARQLResultFormatSingleVarMultipleBindingSets() throws Exception {
<b class="nc">&nbsp;		doTupleNoLinks(getTupleFormat(), createTupleSingleVarMultipleBindingSets(),</b>
<b class="nc">&nbsp;				createTupleSingleVarMultipleBindingSets());</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testSPARQLResultFormatMultipleBindingsMultipleBindingSets() throws Exception {
<b class="nc">&nbsp;		doTupleNoLinks(getTupleFormat(), createTupleMultipleBindingSets(), createTupleMultipleBindingSets());</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testSPARQLResultFormatNoResults() throws Exception {
<b class="nc">&nbsp;		doTupleNoLinks(getTupleFormat(), createTupleNoBindingSets(), createTupleNoBindingSets());</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testNoHandlerNoResults() throws Exception {
<b class="nc">&nbsp;		doTupleNoHandler(getTupleFormat(), createTupleNoBindingSets(), createTupleNoBindingSets());</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testNoHandlerWithResults() throws Exception {
<b class="nc">&nbsp;		doTupleNoHandler(getTupleFormat(), createTupleMultipleBindingSets(), createTupleMultipleBindingSets());</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testTupleParseNoHandlerOnBooleanResults() throws Exception {
<b class="nc">&nbsp;		doTupleParseNoHandlerOnBooleanResults(getTupleFormat(), true, getMatchingBooleanFormatOrNull());</b>
<b class="nc">&nbsp;		doTupleParseNoHandlerOnBooleanResults(getTupleFormat(), false, getMatchingBooleanFormatOrNull());</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testNoLinksNoResults() throws Exception {
<b class="nc">&nbsp;		doTupleLinks(getTupleFormat(), createTupleNoBindingSets(), createTupleNoBindingSets(), List.&lt;String&gt;of());</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testNoLinksWithResults() throws Exception {
<b class="nc">&nbsp;		doTupleLinks(getTupleFormat(), createTupleMultipleBindingSets(), createTupleMultipleBindingSets(),</b>
<b class="nc">&nbsp;				List.&lt;String&gt;of());</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testOneLinkNoResults() throws Exception {
<b class="nc">&nbsp;		doTupleLinks(getTupleFormat(), createTupleNoBindingSets(), createTupleNoBindingSets(), List.of(&quot;info&quot;));</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testOneLinkWithResults() throws Exception {
<b class="nc">&nbsp;		doTupleLinks(getTupleFormat(), createTupleMultipleBindingSets(), createTupleMultipleBindingSets(),</b>
<b class="nc">&nbsp;				List.of(&quot;info&quot;));</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testMultipleLinksNoResults() throws Exception {
<b class="nc">&nbsp;		doTupleLinks(getTupleFormat(), createTupleNoBindingSets(), createTupleNoBindingSets(),</b>
<b class="nc">&nbsp;				Arrays.asList(&quot;info&quot;, &quot;alternate&quot;, &quot;other&quot;, &quot;another&quot;));</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testMultipleLinksWithResults() throws Exception {
<b class="nc">&nbsp;		doTupleLinks(getTupleFormat(), createTupleMultipleBindingSets(), createTupleMultipleBindingSets(),</b>
<b class="nc">&nbsp;				Arrays.asList(&quot;info&quot;, &quot;alternate&quot;, &quot;other&quot;, &quot;another&quot;));</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testMultipleLinksWithResultsAndStylesheet() throws Exception {
<b class="nc">&nbsp;		doTupleLinksAndStylesheet(getTupleFormat(), createTupleMultipleBindingSets(), createTupleMultipleBindingSets(),</b>
<b class="nc">&nbsp;				Arrays.asList(&quot;info&quot;, &quot;alternate&quot;, &quot;other&quot;, &quot;another&quot;), &quot;test.xsl&quot;);</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testMultipleLinksWithResultsAndStylesheetAndNamespaces() throws Exception {
<b class="nc">&nbsp;		doTupleLinksAndStylesheetAndNamespaces(getTupleFormat(), createTupleMultipleBindingSets(),</b>
<b class="nc">&nbsp;				createTupleMultipleBindingSets(), Arrays.asList(&quot;info&quot;, &quot;alternate&quot;, &quot;other&quot;, &quot;another&quot;), &quot;test.xsl&quot;,</b>
<b class="nc">&nbsp;				getNamespaces());</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testMultipleLinksWithResultsAndStylesheetAndNamespacesQName() throws Exception {
<b class="nc">&nbsp;		doTupleLinksAndStylesheetAndNamespacesQName(getTupleFormat(), createTupleMultipleBindingSets(),</b>
<b class="nc">&nbsp;				createTupleMultipleBindingSets(), Arrays.asList(&quot;info&quot;, &quot;alternate&quot;, &quot;other&quot;, &quot;another&quot;), &quot;test.xsl&quot;,</b>
<b class="nc">&nbsp;				getNamespaces());</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testMultipleLinksWithResultsAndStylesheetAndNamespacesWithEmpty() throws Exception {
<b class="nc">&nbsp;		doTupleLinksAndStylesheetAndNamespaces(getTupleFormat(), createTupleMultipleBindingSets(),</b>
<b class="nc">&nbsp;				createTupleMultipleBindingSets(), Arrays.asList(&quot;info&quot;, &quot;alternate&quot;, &quot;other&quot;, &quot;another&quot;), &quot;test.xsl&quot;,</b>
<b class="nc">&nbsp;				getNamespacesWithEmpty());</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testMultipleLinksWithResultsAndStylesheetAndNamespacesQNameWithEmpty() throws Exception {
<b class="nc">&nbsp;		doTupleLinksAndStylesheetAndNamespacesQName(getTupleFormat(), createTupleMultipleBindingSets(),</b>
<b class="nc">&nbsp;				createTupleMultipleBindingSets(), Arrays.asList(&quot;info&quot;, &quot;alternate&quot;, &quot;other&quot;, &quot;another&quot;), &quot;test.xsl&quot;,</b>
<b class="nc">&nbsp;				getNamespacesWithEmpty());</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testMultipleLinksWithResultsAndStylesheetNoStarts() throws Exception {
<b class="nc">&nbsp;		doTupleLinksAndStylesheetNoStarts(getTupleFormat(), createTupleMultipleBindingSets(),</b>
<b class="nc">&nbsp;				createTupleMultipleBindingSets(), Arrays.asList(&quot;info&quot;, &quot;alternate&quot;, &quot;other&quot;, &quot;another&quot;), &quot;test.xsl&quot;);</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testMultipleLinksWithResultsAndStylesheetMultipleEndHeaders() throws Exception {
<b class="nc">&nbsp;		doTupleLinksAndStylesheetMultipleEndHeaders(getTupleFormat(), createTupleMultipleBindingSets(),</b>
<b class="nc">&nbsp;				createTupleMultipleBindingSets(), Arrays.asList(&quot;info&quot;, &quot;alternate&quot;, &quot;other&quot;, &quot;another&quot;), &quot;test.xsl&quot;);</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testNoResultsAndStylesheet() throws Exception {
<b class="nc">&nbsp;		doTupleStylesheet(getTupleFormat(), createTupleNoBindingSets(), createTupleNoBindingSets(), &quot;test.xsl&quot;);</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testMultipleResultsAndStylesheet() throws Exception {
<b class="nc">&nbsp;		doTupleStylesheet(getTupleFormat(), createTupleMultipleBindingSets(), createTupleMultipleBindingSets(),</b>
&nbsp;				&quot;test.xsl&quot;);
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testMultipleResultsJSONPCallback() throws Exception {
<b class="nc">&nbsp;		doTupleJSONPCallback(getTupleFormat(), createTupleMultipleBindingSets(), createTupleMultipleBindingSets());</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testNoResultsJSONPCallback() throws Exception {
<b class="nc">&nbsp;		doTupleJSONPCallback(getTupleFormat(), createTupleNoBindingSets(), createTupleNoBindingSets());</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testNoResultsExceptionHandleSolutionBeforeStartQueryResult() throws Exception {
<b class="nc">&nbsp;		doTupleMissingStartQueryResult(getTupleFormat(), createTupleNoBindingSets(), createTupleNoBindingSets(),</b>
<b class="nc">&nbsp;				Arrays.asList(&quot;info&quot;, &quot;alternate&quot;, &quot;other&quot;, &quot;another&quot;), &quot;test.xsl&quot;);</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testMultipleExceptionHandleSolutionBeforeStartQueryResult() throws Exception {
<b class="nc">&nbsp;		doTupleMissingStartQueryResult(getTupleFormat(), createTupleMultipleBindingSets(),</b>
<b class="nc">&nbsp;				createTupleMultipleBindingSets(), Arrays.asList(&quot;info&quot;, &quot;alternate&quot;, &quot;other&quot;, &quot;another&quot;), &quot;test.xsl&quot;);</b>
&nbsp;	}
&nbsp;
&nbsp;	@Test
&nbsp;	public final void testRDFStarCompatibility() throws IOException {
<b class="nc">&nbsp;		ValueFactory vf = SimpleValueFactory.getInstance();</b>
&nbsp;
<b class="nc">&nbsp;		List&lt;String&gt; bindingNames = Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;);</b>
<b class="nc">&nbsp;		List&lt;BindingSet&gt; bindings = new ArrayList&lt;&gt;();</b>
<b class="nc">&nbsp;		MapBindingSet bs1 = new MapBindingSet();</b>
&nbsp;		// Note that the CSV format seems to ignore the datatype and assume it&#39;s xsd:integer
&nbsp;		// so no other datatype works with it properly.
<b class="nc">&nbsp;		bs1.addBinding(&quot;a&quot;, vf.createLiteral(&quot;1984&quot;, XSD.INTEGER));</b>
<b class="nc">&nbsp;		bs1.addBinding(&quot;b&quot;, vf.createIRI(&quot;urn:test&quot;));</b>
<b class="nc">&nbsp;		bs1.addBinding(&quot;c&quot;, vf.createBNode(&quot;bnode1&quot;));</b>
<b class="nc">&nbsp;		bindings.add(bs1);</b>
<b class="nc">&nbsp;		MapBindingSet bs2 = new MapBindingSet();</b>
<b class="nc">&nbsp;		bs2.addBinding(&quot;a&quot;, vf.createLiteral(&quot;foo&quot;));</b>
<b class="nc">&nbsp;		bs2.addBinding(&quot;b&quot;, vf.createTriple(vf.createBNode(&quot;bnode2&quot;), RDFS.LABEL,</b>
<b class="nc">&nbsp;				vf.createLiteral(&quot;\&quot;literal with\tfunny\nchars&quot;)));</b>
<b class="nc">&nbsp;		bs2.addBinding(&quot;c&quot;, vf.createTriple(vf.createTriple(vf.createTriple(vf.createIRI(&quot;urn:a&quot;), RDF.TYPE,</b>
<b class="nc">&nbsp;				vf.createIRI(&quot;urn:b&quot;)), vf.createIRI(&quot;urn:c&quot;), vf.createIRI(&quot;urn:d&quot;)), vf.createIRI(&quot;urn:e&quot;),</b>
<b class="nc">&nbsp;				vf.createIRI(&quot;urn:f&quot;)));</b>
<b class="nc">&nbsp;		bindings.add(bs2);</b>
&nbsp;
<b class="nc">&nbsp;		try (ByteArrayOutputStream bos = new ByteArrayOutputStream()) {</b>
<b class="nc">&nbsp;			QueryResultIO.writeTuple(new IteratingTupleQueryResult(bindingNames, bindings), getTupleFormat(), bos);</b>
<b class="nc">&nbsp;			try (ByteArrayInputStream bis = new ByteArrayInputStream(bos.toByteArray())) {</b>
<b class="nc">&nbsp;				TupleQueryResult parsedBindings = QueryResultIO.parseTuple(bis, getTupleFormat(),</b>
&nbsp;						null);
<b class="nc">&nbsp;				assertEquals(bindingNames, parsedBindings.getBindingNames());</b>
<b class="nc">&nbsp;				List&lt;BindingSet&gt; actualBindings = new ArrayList&lt;&gt;();</b>
<b class="nc">&nbsp;				parsedBindings.forEach(actualBindings::add);</b>
<b class="nc">&nbsp;				assertEquals(bindings, actualBindings);</b>
<b class="nc">&nbsp;			}</b>
<b class="nc">&nbsp;		}</b>
&nbsp;	}
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2022-09-18 08:58</div>
</div>
</body>
</html>
