/*******************************************************************************
 * Copyright (c) 2025 Eclipse RDF4J contributors.
 *
 * All rights reserved. This program and the accompanying materials
 * are made available under the terms of the Eclipse Distribution License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/org/documents/edl-v10.php.
 *
 * SPDX-License-Identifier: BSD-3-Clause
 *******************************************************************************/
// Some portions generated by Codex
package org.eclipse.rdf4j.benchmark.common;

import java.util.EnumMap;
import java.util.List;
import java.util.Map;
import java.util.Objects;

import org.eclipse.rdf4j.benchmark.rio.util.ThemeDataSetGenerator.Theme;

public final class ThemeQueryCatalog {

	public static final int QUERY_COUNT = 8;

	private static final Map<Theme, List<String>> QUERIES = new EnumMap<>(Theme.class);

	static {
		String medicalPrefix = String.join("\n",
				"PREFIX med: <http://example.com/theme/medical/>",
				"PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>",
				"");
		QUERIES.put(Theme.MEDICAL_RECORDS, List.of(
				medicalPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?patient) AS ?count) WHERE {",
						"  ?patient a med:Patient .",
						"  OPTIONAL {",
						"    ?patient med:hasEncounter ?enc .",
						"    ?enc med:recordedOn ?date .",
						"    BIND(?date AS ?optDate)",
						"  }",
						"  FILTER(?optDate >= \"2024-06-01\"^^xsd:date)",
						"  OPTIONAL { ?patient med:hasMedication ?med . }",
						"}"),
				medicalPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?entity) AS ?count) WHERE {",
						"  VALUES ?target { \"DX-200\" \"DX-201\" }",
						"  { ?entity a med:Condition ; med:code ?code . }",
						"  UNION",
						"  { ?entity a med:Medication ; med:code ?code . }",
						"  FILTER(?code = ?target || ?code = \"DX-202\")",
						"  OPTIONAL { ?entity med:code ?alt . }",
						"}"),
				medicalPrefix + String.join("\n",
						"SELECT ?practitioner (COUNT(DISTINCT ?enc) AS ?encCount) WHERE {",
						"  ?enc a med:Encounter ; med:handledBy ?practitioner ; med:recordedOn ?date .",
						"  FILTER(?date IN (\"2024-01-01\"^^xsd:date, \"2024-02-01\"^^xsd:date))",
						"  OPTIONAL { ?enc med:hasCondition ?cond . }",
						"}",
						"GROUP BY ?practitioner",
						"HAVING(COUNT(?enc) > 0)"),
				medicalPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?patient) AS ?count) WHERE {",
						"  ?patient a med:Patient .",
						"  OPTIONAL {",
						"    ?patient med:hasEncounter/med:hasObservation ?obs .",
						"    ?obs med:value ?value .",
						"    BIND(?value AS ?optValue)",
						"  }",
						"  FILTER(?optValue > 60)",
						"  MINUS { ?patient med:name ?name . FILTER(CONTAINS(LCASE(STR(?name)), \"test\")) }",
						"}"),
				medicalPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?enc) AS ?count) WHERE {",
						"  ?enc a med:Encounter ; med:hasCondition ?cond .",
						"  ?cond med:code ?code .",
						"  FILTER(?code = \"DX-200\" || ?code = \"DX-201\")",
						"  FILTER EXISTS { ?enc med:hasObservation ?obs . }",
						"  OPTIONAL { ?enc med:handledBy ?practitioner . }",
						"}"),
				medicalPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?patient) AS ?count) WHERE {",
						"  VALUES ?limit { 55 }",
						"  ?patient a med:Patient ; med:hasEncounter ?enc .",
						"  ?enc med:hasObservation ?obs .",
						"  ?obs med:value ?value .",
						"  FILTER(?value IN (50, 60, 70))",
						"  FILTER NOT EXISTS { ?enc med:hasCondition ?cond . }",
						"}"),
				medicalPrefix + String.join("\n",
						"SELECT ?patient (COUNT(DISTINCT ?med) AS ?medCount) WHERE {",
						"  { ?patient a med:Patient . }",
						"  UNION",
						"  { ?patient med:hasEncounter ?enc . }",
						"  OPTIONAL {",
						"    ?patient med:hasMedication ?med .",
						"    BIND(?med AS ?optMed)",
						"  }",
						"  FILTER(?optMed != ?patient)",
						"}",
						"GROUP BY ?patient",
						"HAVING(COUNT(?med) > 0)"),
				medicalPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?med) AS ?count) WHERE {",
						"  ?med a med:Medication ; med:code ?code .",
						"  FILTER(?code = \"MED-1000\" || ?code = \"MED-1001\")",
						"  FILTER EXISTS { ?patient med:hasMedication ?med . }",
						"  MINUS { ?med med:dosage ?dose . FILTER(CONTAINS(LCASE(STR(?dose)), \"x\")) }",
						"}")));

		String socialPrefix = String.join("\n",
				"PREFIX social: <http://example.com/theme/social/>",
				"PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>",
				"");
		QUERIES.put(Theme.SOCIAL_MEDIA, List.of(
				socialPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?pair) AS ?count) WHERE {",
						"  VALUES ?u { <http://example.com/theme/social/user/0>",
						"              <http://example.com/theme/social/user/1>",
						"              <http://example.com/theme/social/user/2> }",
						"  VALUES ?v { <http://example.com/theme/social/user/0>",
						"              <http://example.com/theme/social/user/1>",
						"              <http://example.com/theme/social/user/2> }",
						"  FILTER(?u != ?v)",
						"  ?u social:follows ?v .",
						"  OPTIONAL { ?u social:name ?optName . }",
						"  FILTER(?optName IN (\"user0\", \"user1\", \"user2\"))",
						"  BIND(CONCAT(STR(?u), STR(?v)) AS ?pair)",
						"}"),
				socialPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?u1) AS ?count) WHERE {",
						"  VALUES ?u1 { <http://example.com/theme/social/user/0>",
						"               <http://example.com/theme/social/user/1>",
						"               <http://example.com/theme/social/user/2> }",
						"  VALUES ?u2 { <http://example.com/theme/social/user/0>",
						"               <http://example.com/theme/social/user/1>",
						"               <http://example.com/theme/social/user/2> }",
						"  VALUES ?u3 { <http://example.com/theme/social/user/0>",
						"               <http://example.com/theme/social/user/1>",
						"               <http://example.com/theme/social/user/2> }",
						"  FILTER(?u1 != ?u2 && ?u1 != ?u3 && ?u2 != ?u3)",
						"  ?u1 social:follows ?u2 .",
						"  ?u2 social:follows ?u1 .",
						"  ?u1 social:follows ?u3 .",
						"  ?u3 social:follows ?u1 .",
						"  ?u2 social:follows ?u3 .",
						"  ?u3 social:follows ?u2 .",
						"  FILTER EXISTS { ?u1 social:name ?name .",
						"                  FILTER(?name = \"user0\" || ?name = \"user1\") }",
						"  MINUS { ?u1 social:follows ?u1 . }",
						"}"),
				socialPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?u) AS ?count) WHERE {",
						"  VALUES ?u { <http://example.com/theme/social/user/3>",
						"              <http://example.com/theme/social/user/4>",
						"              <http://example.com/theme/social/user/5>",
						"              <http://example.com/theme/social/user/6> }",
						"  VALUES ?v { <http://example.com/theme/social/user/3>",
						"              <http://example.com/theme/social/user/4>",
						"              <http://example.com/theme/social/user/5>",
						"              <http://example.com/theme/social/user/6> }",
						"  FILTER(?u != ?v)",
						"  ?u social:follows ?v .",
						"  OPTIONAL { ?v social:name ?optName . }",
						"  FILTER(?optName != \"\")",
						"  FILTER EXISTS { ?v social:follows ?u . }",
						"}"),
				socialPrefix + String.join("\n",
						"SELECT ?u (COUNT(DISTINCT ?v) AS ?degree) WHERE {",
						"  VALUES ?u { <http://example.com/theme/social/user/3>",
						"              <http://example.com/theme/social/user/4>",
						"              <http://example.com/theme/social/user/5>",
						"              <http://example.com/theme/social/user/6> }",
						"  VALUES ?v { <http://example.com/theme/social/user/3>",
						"              <http://example.com/theme/social/user/4>",
						"              <http://example.com/theme/social/user/5>",
						"              <http://example.com/theme/social/user/6> }",
						"  FILTER(?u != ?v)",
						"  ?u social:follows ?v .",
						"  OPTIONAL { ?u social:name ?optName . BIND(?optName AS ?optAlias) }",
						"  FILTER(?optAlias IN (\"user3\", \"user4\", \"user5\", \"user6\"))",
						"}",
						"GROUP BY ?u",
						"HAVING(COUNT(DISTINCT ?v) >= 3)"),
				socialPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?u) AS ?count) WHERE {",
						"  VALUES ?u { <http://example.com/theme/social/user/7>",
						"              <http://example.com/theme/social/user/8>",
						"              <http://example.com/theme/social/user/9>",
						"              <http://example.com/theme/social/user/10>",
						"              <http://example.com/theme/social/user/11> }",
						"  VALUES ?v { <http://example.com/theme/social/user/7>",
						"              <http://example.com/theme/social/user/8>",
						"              <http://example.com/theme/social/user/9>",
						"              <http://example.com/theme/social/user/10>",
						"              <http://example.com/theme/social/user/11> }",
						"  FILTER(?u != ?v)",
						"  ?u social:follows ?v .",
						"  FILTER NOT EXISTS { ?u social:follows ?u . }",
						"  OPTIONAL { ?v social:name ?optName . }",
						"  FILTER(?optName != \"\")",
						"}"),
				socialPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?activity) AS ?count) WHERE {",
						"  VALUES ?u { <http://example.com/theme/social/user/7>",
						"              <http://example.com/theme/social/user/8>",
						"              <http://example.com/theme/social/user/9>",
						"              <http://example.com/theme/social/user/10>",
						"              <http://example.com/theme/social/user/11> }",
						"  {",
						"    ?u social:follows ?v .",
						"    ?v social:follows ?u .",
						"    BIND(?v AS ?activity)",
						"  }",
						"  UNION",
						"  {",
						"    ?post social:authored ?u .",
						"    BIND(?post AS ?activity)",
						"  }",
						"  OPTIONAL { ?u social:name ?optName . }",
						"  FILTER(?optName IN (\"user7\", \"user8\", \"user9\", \"user10\", \"user11\"))",
						"}"),
				socialPrefix + String.join("\n",
						"SELECT ?u (COUNT(DISTINCT ?v) AS ?connections) WHERE {",
						"  VALUES ?u { <http://example.com/theme/social/user/12>",
						"              <http://example.com/theme/social/user/13>",
						"              <http://example.com/theme/social/user/14>",
						"              <http://example.com/theme/social/user/15>",
						"              <http://example.com/theme/social/user/16>",
						"              <http://example.com/theme/social/user/17> }",
						"  VALUES ?v { <http://example.com/theme/social/user/12>",
						"              <http://example.com/theme/social/user/13>",
						"              <http://example.com/theme/social/user/14>",
						"              <http://example.com/theme/social/user/15>",
						"              <http://example.com/theme/social/user/16>",
						"              <http://example.com/theme/social/user/17> }",
						"  FILTER(?u != ?v)",
						"  ?u social:follows ?v .",
						"  OPTIONAL { ?u social:name ?optName . }",
						"  FILTER(?optName != \"\")",
						"}",
						"GROUP BY ?u",
						"HAVING(COUNT(DISTINCT ?v) >= 5)"),
				socialPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?u) AS ?count) WHERE {",
						"  VALUES ?u { <http://example.com/theme/social/user/12>",
						"              <http://example.com/theme/social/user/13>",
						"              <http://example.com/theme/social/user/14>",
						"              <http://example.com/theme/social/user/15>",
						"              <http://example.com/theme/social/user/16>",
						"              <http://example.com/theme/social/user/17> }",
						"  VALUES ?v { <http://example.com/theme/social/user/12>",
						"              <http://example.com/theme/social/user/13>",
						"              <http://example.com/theme/social/user/14>",
						"              <http://example.com/theme/social/user/15>",
						"              <http://example.com/theme/social/user/16>",
						"              <http://example.com/theme/social/user/17> }",
						"  FILTER(?u != ?v)",
						"  ?u social:follows ?v .",
						"  FILTER EXISTS { ?v social:follows ?u . }",
						"  MINUS { ?v social:follows ?v . }",
						"  OPTIONAL { ?v social:name ?optName . }",
						"  FILTER(?optName IN (\"user12\", \"user13\", \"user14\", \"user15\", \"user16\", \"user17\"))",
						"}")));

		String libraryPrefix = String.join("\n",
				"PREFIX lib: <http://example.com/theme/library/>",
				"PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>",
				"");
		QUERIES.put(Theme.LIBRARY, List.of(
				libraryPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?book) AS ?count) WHERE {",
						"  ?book a lib:Book .",
						"  OPTIONAL {",
						"    ?book lib:hasCopy ?copy .",
						"    ?copy lib:locatedAt ?branch .",
						"    BIND(?branch AS ?optBranch)",
						"  }",
						"  FILTER(?optBranch != ?book)",
						"  OPTIONAL { ?book lib:writtenBy ?author . }",
						"}"),
				libraryPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?entity) AS ?count) WHERE {",
						"  VALUES ?target { \"Member 1\" \"Member 2\" }",
						"  { ?entity a lib:Member ; lib:name ?name . }",
						"  UNION",
						"  { ?entity a lib:Book ; lib:title ?name . }",
						"  FILTER(?name = ?target || ?name = \"Member 3\")",
						"  OPTIONAL { ?entity lib:hasCopy ?copy . }",
						"}"),
				libraryPrefix + String.join("\n",
						"SELECT ?author (COUNT(DISTINCT ?book) AS ?bookCount) WHERE {",
						"  ?author a lib:Author ; lib:name ?authorName .",
						"  FILTER(?authorName IN (\"Author 1\", \"Author 2\", \"Author 3\"))",
						"  OPTIONAL { ?book lib:writtenBy ?author . }",
						"}",
						"GROUP BY ?author",
						"HAVING(COUNT(?book) > 0)"),
				libraryPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?loan) AS ?count) WHERE {",
						"  ?loan a lib:Loan ; lib:borrowedBy ?member .",
						"  OPTIONAL {",
						"    ?loan lib:dueDate ?due .",
						"    BIND(?due AS ?optDue)",
						"  }",
						"  FILTER(?optDue > \"2024-01-10\"^^xsd:date)",
						"  MINUS { ?member lib:name ?name . FILTER(CONTAINS(LCASE(STR(?name)), \"member 1\")) }",
						"}"),
				libraryPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?book) AS ?count) WHERE {",
						"  ?book a lib:Book ; lib:title ?title .",
						"  FILTER(?title = \"Book 1\" || ?title = \"Book 2\")",
						"  FILTER EXISTS { ?book lib:hasCopy ?copy . }",
						"  OPTIONAL { ?book lib:writtenBy ?author . }",
						"}"),
				libraryPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?loan) AS ?count) WHERE {",
						"  VALUES ?threshold { \"2024-01-01\"^^xsd:date }",
						"  ?loan a lib:Loan ; lib:loanDate ?loanDate .",
						"  FILTER(?loanDate IN (\"2024-01-01\"^^xsd:date, \"2024-01-02\"^^xsd:date))",
						"  FILTER NOT EXISTS { ?loan lib:dueDate ?due . FILTER(?due < ?threshold) }",
						"}"),
				libraryPrefix + String.join("\n",
						"SELECT ?member (COUNT(DISTINCT ?loan) AS ?loanCount) WHERE {",
						"  { ?loan a lib:Loan ; lib:borrowedBy ?member . }",
						"  UNION",
						"  { ?member a lib:Member . }",
						"  OPTIONAL {",
						"    ?loan lib:loanedCopy ?copy .",
						"    BIND(?copy AS ?optCopy)",
						"  }",
						"  FILTER(?optCopy != ?member)",
						"}",
						"GROUP BY ?member",
						"HAVING(COUNT(?loan) > 0)"),
				libraryPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?copy) AS ?count) WHERE {",
						"  ?copy a lib:Copy ; lib:locatedAt ?branch .",
						"  ?branch lib:name ?branchName .",
						"  FILTER(?branchName = \"Branch 0\" || ?branchName = \"Branch 1\")",
						"  FILTER EXISTS { ?copy a lib:Copy . }",
						"  MINUS { ?copy lib:locatedAt ?branch . FILTER(CONTAINS(STR(?branch), \"branch/0\")) }",
						"}")));

		String engineeringPrefix = String.join("\n",
				"PREFIX eng: <http://example.com/theme/engineering/>",
				"");
		QUERIES.put(Theme.ENGINEERING, List.of(
				engineeringPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?component) AS ?count) WHERE {",
						"  ?component a eng:Component .",
						"  OPTIONAL { ?component eng:partOf ?assembly . BIND(?assembly AS ?optAssembly) }",
						"  FILTER(?optAssembly != ?component)",
						"  OPTIONAL { ?component eng:dependsOn ?dep . }",
						"}"),
				engineeringPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?entity) AS ?count) WHERE {",
						"  VALUES ?target { \"REQ-1000\" \"REQ-1001\" }",
						"  { ?entity a eng:Requirement ; eng:name ?name . }",
						"  UNION",
						"  { ?entity a eng:Component ; eng:name ?name . }",
						"  FILTER(?name = ?target || ?name = \"REQ-1002\")",
						"  OPTIONAL { ?entity eng:partOf ?assembly . }",
						"}"),
				engineeringPrefix + String.join("\n",
						"SELECT ?assembly (COUNT(DISTINCT ?component) AS ?componentCount) WHERE {",
						"  ?assembly a eng:Assembly ; eng:name ?assemblyName .",
						"  FILTER(?assemblyName IN (\"Assembly 1\", \"Assembly 2\", \"Assembly 3\"))",
						"  OPTIONAL { ?component eng:partOf ?assembly . }",
						"}",
						"GROUP BY ?assembly",
						"HAVING(COUNT(?component) > 0)"),
				engineeringPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?requirement) AS ?count) WHERE {",
						"  ?requirement a eng:Requirement ; eng:satisfies ?component .",
						"  OPTIONAL { ?requirement eng:verifiedBy ?test . BIND(?test AS ?optTest) }",
						"  FILTER(?optTest != ?requirement)",
						"  MINUS { ?component eng:name ?name . FILTER(CONTAINS(STR(?name), \"Component 1\")) }",
						"}"),
				engineeringPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?component) AS ?count) WHERE {",
						"  ?component a eng:Component ; eng:name ?name .",
						"  FILTER(?name = \"Component 1\" || ?name = \"Component 2\")",
						"  FILTER EXISTS { ?component eng:dependsOn ?dep . }",
						"  OPTIONAL { ?component eng:partOf ?assembly . }",
						"}"),
				engineeringPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?measurement) AS ?count) WHERE {",
						"  VALUES ?threshold { 0.85 }",
						"  ?measurement a eng:Measurement ; eng:measuredValue ?value .",
						"  FILTER(?value IN (0.9, 0.95))",
						"  FILTER NOT EXISTS { ?measurement eng:measuredValue ?value2 . FILTER(?value2 < ?threshold) }",
						"}"),
				engineeringPrefix + String.join("\n",
						"SELECT ?component (COUNT(DISTINCT ?requirement) AS ?reqCount) WHERE {",
						"  { ?requirement a eng:Requirement ; eng:satisfies ?component . }",
						"  UNION",
						"  { ?component a eng:Component . }",
						"  OPTIONAL { ?component eng:dependsOn ?dep . BIND(?dep AS ?optDep) }",
						"  FILTER(?optDep != ?component)",
						"}",
						"GROUP BY ?component",
						"HAVING(COUNT(?requirement) > 0)"),
				engineeringPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?requirement) AS ?count) WHERE {",
						"  ?requirement a eng:Requirement ; eng:name ?name .",
						"  FILTER(?name = \"REQ-1000\" || ?name = \"REQ-1001\")",
						"  FILTER EXISTS { ?requirement eng:satisfies ?component . }",
						"  MINUS { ?requirement eng:verifiedBy ?test . ?test eng:verifiedBy ?measurement . }",
						"}")));

		String connectedPrefix = String.join("\n",
				"PREFIX conn: <http://example.com/theme/connected/>",
				"");
		QUERIES.put(Theme.HIGHLY_CONNECTED, List.of(
				connectedPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?node) AS ?count) WHERE {",
						"  ?node a conn:Node .",
						"  OPTIONAL { ?node conn:connectsTo ?neighbor . BIND(?neighbor AS ?optNeighbor) }",
						"  FILTER(?optNeighbor != ?node)",
						"  OPTIONAL { ?node conn:weight ?w . }",
						"}"),
				connectedPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?entity) AS ?count) WHERE {",
						"  VALUES ?target { 1 2 }",
						"  { ?entity a conn:Node ; conn:connectsTo ?targetNode . }",
						"  UNION",
						"  { ?entity a conn:Node . }",
						"  OPTIONAL { ?entity conn:weight ?w . }",
						"  FILTER(?w = ?target || ?w = 3)",
						"}"),
				connectedPrefix + String.join("\n",
						"SELECT ?node (COUNT(DISTINCT ?neighbor) AS ?neighborCount) WHERE {",
						"  ?node a conn:Node ; conn:connectsTo ?neighbor .",
						"  ?node conn:weight ?w .",
						"  FILTER(?w IN (1, 2, 3))",
						"  OPTIONAL { ?neighbor conn:connectsTo ?node . }",
						"}",
						"GROUP BY ?node",
						"HAVING(COUNT(?neighbor) > 0)"),
				connectedPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?node) AS ?count) WHERE {",
						"  ?node a conn:Node .",
						"  OPTIONAL { ?node conn:weight ?w . BIND(?w AS ?optWeight) }",
						"  FILTER(?optWeight > 5)",
						"  MINUS { ?node conn:connectsTo ?neighbor . FILTER(?neighbor = ?node) }",
						"}"),
				connectedPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?node) AS ?count) WHERE {",
						"  ?node a conn:Node ; conn:weight ?w .",
						"  FILTER(?w = 1 || ?w = 2)",
						"  FILTER EXISTS { ?node conn:connectsTo ?neighbor . }",
						"  OPTIONAL { ?neighbor conn:connectsTo ?node . }",
						"}"),
				connectedPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?node) AS ?count) WHERE {",
						"  VALUES ?threshold { 4 }",
						"  ?node a conn:Node ; conn:weight ?w .",
						"  FILTER(?w IN (4, 5, 6))",
						"  FILTER NOT EXISTS { ?node conn:weight ?w2 . FILTER(?w2 < ?threshold) }",
						"}"),
				connectedPrefix + String.join("\n",
						"SELECT ?node (COUNT(DISTINCT ?neighbor) AS ?neighborCount) WHERE {",
						"  { ?node a conn:Node ; conn:connectsTo ?neighbor . }",
						"  UNION",
						"  { ?neighbor conn:connectsTo ?node . }",
						"  OPTIONAL { ?node conn:weight ?w . BIND(?w AS ?optWeight) }",
						"  FILTER(?optWeight != 0)",
						"}",
						"GROUP BY ?node",
						"HAVING(COUNT(?neighbor) > 0)"),
				connectedPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?node) AS ?count) WHERE {",
						"  ?node a conn:Node ; conn:weight ?w .",
						"  FILTER(?w = 8 || ?w = 9)",
						"  FILTER EXISTS { ?node conn:connectsTo ?neighbor . }",
						"  MINUS { ?neighbor conn:connectsTo ?node . FILTER(?neighbor = ?node) }",
						"}")));

		String trainPrefix = String.join("\n",
				"PREFIX train: <http://example.com/theme/train/>",
				"PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>",
				"");
		QUERIES.put(Theme.TRAIN, List.of(
				trainPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?train) AS ?count) WHERE {",
						"  ?train a train:Train .",
						"  OPTIONAL {",
						"    ?train train:hasTrip ?trip .",
						"    ?trip train:departureTime ?time .",
						"    BIND(?time AS ?optTime)",
						"  }",
						"  FILTER(?optTime > \"08:00:00\"^^xsd:time)",
						"  OPTIONAL { ?train train:name ?name . }",
						"}"),
				trainPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?entity) AS ?count) WHERE {",
						"  VALUES ?target { \"Station 1\" \"Station 2\" }",
						"  { ?entity a train:Station ; train:name ?name . }",
						"  UNION",
						"  { ?entity a train:Route ; train:name ?name . }",
						"  FILTER(?name = ?target || ?name = \"Station 3\")",
						"  OPTIONAL { ?entity train:hasStop ?stop . }",
						"}"),
				trainPrefix + String.join("\n",
						"SELECT ?station (COUNT(DISTINCT ?stop) AS ?stopCount) WHERE {",
						"  ?station a train:Station ; train:name ?stationName .",
						"  FILTER(?stationName IN (\"Station 0\", \"Station 1\", \"Station 2\"))",
						"  OPTIONAL { ?stop train:atStation ?station . }",
						"}",
						"GROUP BY ?station",
						"HAVING(COUNT(?stop) > 0)"),
				trainPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?trip) AS ?count) WHERE {",
						"  ?trip a train:Trip ; train:onRoute ?route .",
						"  OPTIONAL { ?trip train:departureTime ?time . BIND(?time AS ?optTime) }",
						"  FILTER(?optTime > \"06:00:00\"^^xsd:time)",
						"  MINUS { ?route train:name ?name . FILTER(CONTAINS(STR(?name), \"Route 0\")) }",
						"}"),
				trainPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?route) AS ?count) WHERE {",
						"  ?route a train:Route ; train:name ?name .",
						"  FILTER(?name = \"Route 1\" || ?name = \"Route 2\")",
						"  FILTER EXISTS { ?route train:hasStop ?stop . }",
						"  OPTIONAL { ?stop train:atStation ?station . }",
						"}"),
				trainPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?train) AS ?count) WHERE {",
						"  VALUES ?threshold { \"10:00:00\"^^xsd:time }",
						"  ?train a train:Train ; train:hasTrip ?trip .",
						"  ?trip train:departureTime ?time .",
						"  FILTER(?time IN (\"08:00:00\"^^xsd:time, \"09:00:00\"^^xsd:time))",
						"  FILTER NOT EXISTS { ?trip train:departureTime ?late . FILTER(?late > ?threshold) }",
						"}"),
				trainPrefix + String.join("\n",
						"SELECT ?route (COUNT(DISTINCT ?trip) AS ?tripCount) WHERE {",
						"  { ?trip a train:Trip ; train:onRoute ?route . }",
						"  UNION",
						"  { ?route a train:Route . }",
						"  OPTIONAL { ?route train:hasStop ?stop . BIND(?stop AS ?optStop) }",
						"  FILTER(?optStop != ?route)",
						"}",
						"GROUP BY ?route",
						"HAVING(COUNT(?trip) > 0)"),
				trainPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?station) AS ?count) WHERE {",
						"  ?station a train:Station ; train:name ?name .",
						"  FILTER(?name = \"Station 1\" || ?name = \"Station 2\")",
						"  FILTER EXISTS { ?stop train:atStation ?station . }",
						"  MINUS { ?station train:name ?name2 . FILTER(CONTAINS(?name2, \"Station 0\")) }",
						"}")));

		String gridPrefix = String.join("\n",
				"PREFIX grid: <http://example.com/theme/grid/>",
				"");
		QUERIES.put(Theme.ELECTRICAL_GRID, List.of(
				gridPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?substation) AS ?count) WHERE {",
						"  ?substation a grid:Substation .",
						"  OPTIONAL { ?generator grid:feeds ?substation ; grid:capacity ?cap . BIND(?cap AS ?optCap) }",
						"  FILTER(?optCap > 600)",
						"  OPTIONAL { ?substation grid:name ?name . }",
						"}"),
				gridPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?entity) AS ?count) WHERE {",
						"  VALUES ?target { \"Substation 1\" \"Substation 2\" }",
						"  { ?entity a grid:Substation ; grid:name ?name . }",
						"  UNION",
						"  { ?entity a grid:Generator ; grid:feeds ?substation . ?substation grid:name ?name . }",
						"  FILTER(?name = ?target || ?name = \"Substation 3\")",
						"  OPTIONAL { ?entity grid:feeds ?substation2 . }",
						"}"),
				gridPrefix + String.join("\n",
						"SELECT ?transformer (COUNT(DISTINCT ?meter) AS ?meterCount) WHERE {",
						"  ?transformer a grid:Transformer ; grid:feeds ?substation .",
						"  ?substation grid:name ?name .",
						"  FILTER(?name IN (\"Substation 0\", \"Substation 1\", \"Substation 2\"))",
						"  OPTIONAL { ?transformer grid:hasMeter ?meter . }",
						"}",
						"GROUP BY ?transformer",
						"HAVING(COUNT(?meter) > 0)"),
				gridPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?meter) AS ?count) WHERE {",
						"  ?meter a grid:Meter ; grid:measures ?load .",
						"  OPTIONAL { ?load grid:loadValue ?value . BIND(?value AS ?optValue) }",
						"  FILTER(?optValue > 100)",
						"  MINUS { ?meter grid:measures ?load2 . ?load2 grid:loadValue ?value2 . FILTER(?value2 > 180) }",
						"}"),
				gridPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?line) AS ?count) WHERE {",
						"  ?line a grid:Line ; grid:connectsTo ?substation .",
						"  ?substation grid:name ?name .",
						"  FILTER(?name = \"Substation 0\" || ?name = \"Substation 1\")",
						"  FILTER EXISTS { ?line grid:connectsTo ?other . }",
						"  OPTIONAL { ?line grid:connectsTo ?other2 . }",
						"}"),
				gridPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?generator) AS ?count) WHERE {",
						"  VALUES ?threshold { 700 }",
						"  ?generator a grid:Generator ; grid:capacity ?capacity .",
						"  FILTER(?capacity IN (700, 800, 900))",
						"  FILTER NOT EXISTS { ?generator grid:capacity ?cap2 . FILTER(?cap2 < ?threshold) }",
						"}"),
				gridPrefix + String.join("\n",
						"SELECT ?substation (COUNT(DISTINCT ?asset) AS ?assetCount) WHERE {",
						"  { ?asset a grid:Transformer ; grid:feeds ?substation . }",
						"  UNION",
						"  { ?asset a grid:Generator ; grid:feeds ?substation . }",
						"  OPTIONAL { ?asset grid:feeds ?substation . BIND(?substation AS ?optSub) }",
						"  FILTER(?optSub != ?asset)",
						"}",
						"GROUP BY ?substation",
						"HAVING(COUNT(?asset) > 0)"),
				gridPrefix + String.join("\n",
						"SELECT (COUNT(DISTINCT ?transformer) AS ?count) WHERE {",
						"  ?transformer a grid:Transformer ; grid:feeds ?substation .",
						"  ?substation grid:name ?name .",
						"  FILTER(?name = \"Substation 0\" || ?name = \"Substation 1\")",
						"  FILTER EXISTS { ?transformer grid:hasMeter ?meter . }",
						"  MINUS { ?meter grid:measures ?load . FILTER(?load = ?substation) }",
						"}")));

		validateQueries();
	}

	private ThemeQueryCatalog() {
	}

	public static List<String> queriesFor(Theme theme) {
		Objects.requireNonNull(theme, "theme");
		return QUERIES.get(theme);
	}

	public static String queryFor(Theme theme, int index) {
		Objects.requireNonNull(theme, "theme");
		List<String> queries = QUERIES.get(theme);
		if (queries == null) {
			throw new IllegalArgumentException("No queries registered for theme " + theme);
		}
		if (index < 0 || index >= queries.size()) {
			throw new IllegalArgumentException("Query index out of range: " + index);
		}
		return queries.get(index);
	}

	private static void validateQueries() {
		for (Theme theme : Theme.values()) {
			List<String> queries = QUERIES.get(theme);
			if (queries == null) {
				throw new IllegalStateException("Missing query list for theme " + theme);
			}
			if (queries.size() != QUERY_COUNT) {
				throw new IllegalStateException("Theme " + theme + " has " + queries.size() + " queries");
			}
		}
	}
}
